# Registry


<!-- WARNING: THIS FILE WAS AUTOGENERATED! DO NOT EDIT! -->

## Unified Plugin Registry

The
[`UnifiedPluginRegistry`](https://cj-mills.github.io/cjm-fasthtml-plugins/core/registry.html#unifiedpluginregistry)
manages multiple domain-specific plugin systems (transcription, LLM,
image generation, etc.) in a single application. It provides:

- String-based categories (no hardcoded enums)
- Configuration persistence (JSON files)
- Integration with FastHTML settings and resource management
- Support for local and cloud plugins

This registry works with any plugin system built on `cjm-plugin-system`.

------------------------------------------------------------------------

<a
href="https://github.com/cj-mills/cjm-fasthtml-plugins/blob/main/cjm_fasthtml_plugins/core/registry.py#L20"
target="_blank" style="float:right; font-size:smaller">source</a>

### UnifiedPluginRegistry

>  UnifiedPluginRegistry (config_dir:Optional[pathlib.Path]=None)

*Unified registry for multiple domain-specific plugin systems with
configuration persistence.*

<table>
<colgroup>
<col style="width: 6%" />
<col style="width: 25%" />
<col style="width: 34%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr>
<th></th>
<th><strong>Type</strong></th>
<th><strong>Default</strong></th>
<th><strong>Details</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>config_dir</td>
<td>Optional</td>
<td>None</td>
<td>Directory for plugin configuration files (default: ‘configs’)</td>
</tr>
</tbody>
</table>

## Example Usage

``` python
# Create a mock plugin manager for testing
from dataclasses import dataclass, field
from cjm_plugin_system.utils.validation import SCHEMA_TITLE, SCHEMA_DESC, SCHEMA_ENUM

@dataclass
class MockPluginData:
    name: str
    version: str

@dataclass
class WhisperTinyConfig:
    """Configuration for Whisper Tiny model."""
    __schema_name__ = "whisper_tiny"
    __schema_title__ = "Whisper Tiny Configuration"
    __schema_description__ = "Configuration for whisper_tiny"
    
    device: str = field(default="cpu", metadata={SCHEMA_ENUM: ["cpu", "cuda"]})

@dataclass
class WhisperBaseConfig:
    """Configuration for Whisper Base model."""
    __schema_name__ = "whisper_base"
    __schema_title__ = "Whisper Base Configuration"
    __schema_description__ = "Configuration for whisper_base"
    
    device: str = field(default="cpu", metadata={SCHEMA_ENUM: ["cpu", "cuda"]})

class MockPluginManager:
    """Mock plugin manager for testing."""
    
    def __init__(self):
        self._config_dataclasses = {
            "whisper_tiny": WhisperTinyConfig,
            "whisper_base": WhisperBaseConfig
        }
    
    def discover_plugins(self):
        return [
            MockPluginData("whisper_tiny", "1.0.0"),
            MockPluginData("whisper_base", "1.0.0")
        ]

    def get_plugin_config_dataclass(self, name:str):
        return self._config_dataclasses.get(name)
```

``` python
# Example: Create registry and register a plugin manager
import tempfile

with tempfile.TemporaryDirectory() as tmpdir:
    registry = UnifiedPluginRegistry(config_dir=Path(tmpdir))
    
    # Register transcription plugin manager
    mock_manager = MockPluginManager()
    discovered = registry.register_plugin_manager(
        category="transcription",
        manager=mock_manager,
        display_name="Transcription Plugins"
    )
    
    print(f"Discovered {len(discovered)} plugins")
    for plugin in discovered:
        print(f"  - {plugin.title} (v{plugin.version})")
```

    Discovered 2 plugins
      - Whisper Tiny Configuration (v1.0.0)
      - Whisper Base Configuration (v1.0.0)

``` python
# Example: Query registry
with tempfile.TemporaryDirectory() as tmpdir:
    registry = UnifiedPluginRegistry(config_dir=Path(tmpdir))
    registry.register_plugin_manager("transcription", MockPluginManager())
    
    # Get categories
    print(f"Categories: {registry.get_categories()}")
    print(f"Categories with plugins: {registry.get_categories_with_plugins()}")
    
    # Get plugins
    plugins = registry.get_plugins_by_category("transcription")
    print(f"\nTranscription plugins: {len(plugins)}")
    for plugin in plugins:
        print(f"  - {plugin.name} ({plugin.get_unique_id()})")
    
    # Get specific plugin
    plugin = registry.get_plugin("transcription_whisper_tiny")
    print(f"\nPlugin metadata:")
    print(f"  Title: {plugin.title}")
    print(f"  Category: {plugin.category}")
    print(f"  Is configured: {plugin.is_configured}")
```

    Categories: ['transcription']
    Categories with plugins: ['transcription']

    Transcription plugins: 2
      - whisper_tiny (transcription_whisper_tiny)
      - whisper_base (transcription_whisper_base)

    Plugin metadata:
      Title: Whisper Tiny Configuration
      Category: transcription
      Is configured: False

``` python
# Example: Save and load plugin configuration
with tempfile.TemporaryDirectory() as tmpdir:
    registry = UnifiedPluginRegistry(config_dir=Path(tmpdir))
    registry.register_plugin_manager("transcription", MockPluginManager())
    
    unique_id = "transcription_whisper_tiny"
    
    # Check initial state
    plugin = registry.get_plugin(unique_id)
    print(f"Initially configured: {plugin.is_configured}")
    
    # Save configuration
    config = {"device": "cuda", "model_size": "tiny"}
    success = registry.save_plugin_config(unique_id, config)
    print(f"Save succeeded: {success}")
    
    # Check updated state
    plugin = registry.get_plugin(unique_id)
    print(f"Now configured: {plugin.is_configured}")
    
    # Load configuration
    loaded_config = registry.load_plugin_config(unique_id)
    print(f"Loaded config: {loaded_config}")
    
    # Delete configuration
    success = registry.delete_plugin_config(unique_id)
    print(f"Delete succeeded: {success}")
    
    # Check final state
    plugin = registry.get_plugin(unique_id)
    print(f"Finally configured: {plugin.is_configured}")
```

    Initially configured: False
    Save succeeded: True
    Now configured: True
    Loaded config: {'device': 'cuda', 'model_size': 'tiny'}
    Delete succeeded: True
    Finally configured: False

``` python
# Example: Register multiple plugin managers (multi-domain)
@dataclass
class LlamaConfig:
    """Configuration for Llama model."""
    __schema_name__ = "llama3"
    __schema_title__ = "Llama3 Config"
    __schema_description__ = "Configuration for llama3"

@dataclass
class GPT4Config:
    """Configuration for GPT-4 model."""
    __schema_name__ = "gpt4"
    __schema_title__ = "GPT4 Config"
    __schema_description__ = "Configuration for gpt4"

class MockLLMManager:
    def __init__(self):
        self._config_dataclasses = {
            "llama3": LlamaConfig,
            "gpt4": GPT4Config
        }
    
    def discover_plugins(self):
        return [MockPluginData("llama3", "1.0.0"), MockPluginData("gpt4", "1.0.0")]
    
    def get_plugin_config_dataclass(self, name: str):
        return self._config_dataclasses.get(name)

with tempfile.TemporaryDirectory() as tmpdir:
    registry = UnifiedPluginRegistry(config_dir=Path(tmpdir))
    
    # Register multiple domains
    registry.register_plugin_manager("transcription", MockPluginManager())
    registry.register_plugin_manager("llm", MockLLMManager(), display_name="Language Models")
    
    # Show all categories and plugins
    print("Categories:")
    for category in registry.get_categories():
        display = registry.get_category_display_name(category)
        plugins = registry.get_plugins_by_category(category)
        print(f"  {display} ({category}): {len(plugins)} plugins")
    
    # Show all plugins
    print(f"\nTotal plugins: {len(registry.get_all_plugins())}")
    for plugin in registry.get_all_plugins():
        print(f"  - [{plugin.category}] {plugin.name}")
```

    Categories:
      Language Models (llm): 2 plugins
      Transcription (transcription): 2 plugins

    Total plugins: 4
      - [transcription] whisper_tiny
      - [transcription] whisper_base
      - [llm] llama3
      - [llm] gpt4
